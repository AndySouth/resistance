---
title: "paper2_resistance_mechanisms_mixtures"
output: pdf_document
#output: word_document
author: "Andy South, Ian Hastings and Bethany Levick"
date: "`r Sys.Date()`"
---

```{r,echo=FALSE,results='hide'}
  library(resistance)
  library(ggplot2)
```

### version 6
 
# Mechanisms by which insecticide resistance can be influenced by strategies of insecticide use : exploring by simulation. 

Target : Malaria journal

THIS IS A CONFIDENTIAL COPY OF THE MS. Please do not circulate without the express permission of one of the authors. All comments and & suggestions welcome.
  
(This file is automagically generated by R from paper2_resistance_mechanisms_mixtures.Rmd)

## ANDY TO DO
1. work out what's going on with exposure ... why does increasing exposure have a greater effect on mixture than sequential ? 
1. add to intro including about about results in levick et al. 
1. explain resistance-restoration and its relation to selection coefficient
1. expand discussion to include relevance to real world 


## Abstract

This paper explores the mechanisms by which insectide resistance is expected to increase with the use of insecticides in isolation, sequence and mixtures. It is aimed at a readership with limited experience of population genetics and resistance. It uses a model representing two independent genes coding for resistance to two insecticides. It explores factors that are expected to influence the development of resitance, notably the starting frequency of resistance alleles, their dominance, the exposure of insects to the insecticides, the effectiveness of the insecticides, and how resistance restores fitness in the presence of the insecticides. We use the model to develop a mechanistic understanding of how the values of these parameters are expected to influence the development of resistance and the relative benefits of alternative insecticide application strategies. We expect this mechanistic understanding to be more robust to uncertainty in parameter values in the field. We describe an R package and user-interface that allows further exploration of the development of resistance. The user-interface (https://andysouth.shinyapps.io/MixSeqResist1) allows replication of our results and exploration of what happens when inputs are changed outside of the ranges we have used. 

## Introduction

Insecticide resistance is a problem for malaria (GPIRM), other vector borne diseases and agriculture.

Insecticide resistance becomes a problem when genes coding for resistance firstly arise in a population and secondly increase in frequency. We concern ourselves with this second process of how insecticide resistance increases in frequency within a population.

The changing frequency of insecticide resistance is a population genetic process that can be influenced by the parameters outlined in Table 1.


We use a 2-locus population genetic model of insecticide resistance (Levick et al. in press) to illustrate the mechanisms by which these parameters are expected to influence the development of insectide resistance under alternative insecticide use strategies. Levick et al. (in press) describe the technical details of the model and explore large parameter ranges. We provide an accessible summary of the model and use selected parameter values to develop a mechanistic understanding of how inputs influence the development of resistance. This mechanistic understanding can provide a more robust framework for the debate on the relative merits of different insecticide use strategies. 


**Table 1. Parameters inflencing the development of insecticide resistance**

Parameter  | Description
------------------- | -------------------------------------------------------
1. Effectiveness | proportion of exposed insects with both susceptible alleles that are killed by the insecticide
2. Exposure | proportion of the insect population that are exposed to the insecticide
3. Dominance | dominance of the resistance allele relative to the susceptible allele
4. Resistance restoration  | ability of resistance to restore fitness in the presence of the insecticide
5. Frequency  | frequency of resistance alleles within the population


## Methods

The simulation represents a population of randomly mixing individuals using standard population genetic approaches to avoid the need to follow every individual. One locus is represented for each insecticide. There are two potential alleles per locus. Each allele confers either resistance or susceptibility to the insecticide. The fitness of an individual depends on it's alleles, exposure to the insecticide and other inputs that can be set in the model. These inputs include the effectiveness of the insecticide, the dominance of the resistance allele and the ability of resistance to restore fitness in the presence of the insecticide (see Table 1).  


The simulation proceeds through generations. In each generation selection is represented by multiplying genotype frequencies in the population by their relative fitness. This acts to make the fitter alleles more common over time. Thus a summary of the selection stage is :

> selection coefficient = resistance restoration * effectiveness  
>
> Locus fitness : 	
> SS = 1-effectiveness  
> RS = 1-effectiveness + (dominance*selection coeff.)  
> RR = 1-effectiveness + selection coeff.  
> 
> Allele fitness :   
> SS1SS2 = SS * SS  
> SS1RS2 = SS * RS  
> â€¦ and for other combinations  
> RR1RR2 = RR * RR  
> 
> Population fitness = Allele fitness * exposure to insecticide  
> 
> In each generation :   
> Allele frequency[t+1] = Allele frequency[t] * Population fitness  


Sexual reproduction is represented first by creating gametes by splitting the adult genomes in two with recombination, and second by forming offspring genotypes by adding gametes.

So far this description has just considered a single insecticide and associated resistance allele (Fig 1A). In the simulation a second insecticide and resistance allele are included and fitness is calculated by multiplying these with those for the first insecticide described above (Fig 1C). Thus the simulation can represent populations exposed to two insecticides together in a mixture. 


In addition the model structure allows for 3 different levels of exposure to be set for each insecticide (Fig 2). So in the two insecticide case that gives the potential for nine (3*3) different exposure niches. In the runs shown here we have just used two levels of exposure for each insecticide (effectively no or yes with the value for yes set from the exposure input in Table 1). The model structure allows males and females to experience different exposures, we explore that in Levick et al. (in press) but the runs presented here use equal exposures.


Here we principally look at model outputs of the change in allele frequencies over time (generations). We investigate three insecticide use strategies.

1. single insecticide
1. two insecticides used in sequence, replacing the first with a second once the proportion of resistance alleles reaches 50%
1. two insecticides used in a mixture (concurrently)


## Results


### Single insecticide
For single insecticide use, faster resistance spread resulted from higher values of any of the inputs outlined in Table 1, namely effectiveness, exposure, dominance, the resistance restoration coefficient, and starting frequencies of resistance (Figs 3-5). In the plots each input was varied in isolation with the remaining set to 0.5 (except for starting frequency of resistance which was set to 0.01 in all bar Fig 5).


### Two insecticides
When two insecticides are used the relative performance of a mixture strategy compared to sequential use changes dependent on input values. To help us understand the mechanisms influencing this relative performance we started with a single base scenario and investigated changing inputs individually. The base scenario was similar to that used for the single insecticide. Values for the first four inputs in Table 1 were set to 0.5 and the starting frequencies of resistance to 0.01. For this base scenario resistance arises slower for sequential than mixture (Fig 6A). This plot, and those that follow, compares mixture and sequence for a single combination of inputs. Resistance to both insecticides in the mixture follow the same path and reach the threshold at the same time (as would be expected given that they have identical input parameters). When used in sequence the curve (dashed) for each insecticide individually is steeper than in the mixture but, because they happen one after the other, it takes longer for both to reach the resistance threshold of 50%.


#### results: Insecticide effectiveness
A more effective insecticide increases time-to-resistance when used in a mixture. This is opposite to what happens when used in sequence and in isolation, when both shortened times-to-resistance.

For example, taking the base scenario and increasing the effectiveness of one insecticide from 0.5 to 0.8 increases the time-to-resistance for the mixture (from 90 to 115 generations) and decreases that for the sequence (from 120 to 90 generations) (Fig 6). Thus at low effectiveness a sequential strategy is favoured while at higher effectiveness a mixture is favoured.  

When the effectiveness of both insecticides are increased to 0.8 the time-to-resistance is increased still further to around 125 generations (Fig 7).


#### results: Exposure
Increasing exposure to 0.8 from the base scenario reduces time-to-resistance for both mixture and sequential scenarios (Fig 8A relative to 6A). The increase in exposure has a greater effect on the mixture relative to the sequential strategy and this results in a greater relative benefit for sequence versus mixture. 

Similarly increasing exposure reduces time-to-resistance more for the mixture relative to sequence in the scenario in which one insecticide effectiveness has been increased (compare Fig 8B to 6B). The result is that the advantage of mixtures over sequence is removed by the increase in exposure.


#### results: Dominance of resistance alleles
Increasing the dominance of the alleles within a mixture has the same direction of effect as it does for sole use. Increasing the dominance of the allele corresponding to insecticide1 from 0.5 to 0.8 decreases the time-to-resistance to insecticide1 within the mixture but leaves the time-to-resistance for the second insecticide in the mixture the same (Fig 9A). Setting the dominance for both alleles to 0.8 reduces the time-to-resistance for both the mixture and the sequence by 20 generations from the base scenario (compare Fig 9B to 6A). In both of these cases sequential use continues to have a longer time-to-resistance under the higher dominance.


#### results: Resistance restoration coefficient
Increasing the resistance restoration coefficient to insecticide1 from 0.5 to 0.8 decreases the time-to-resistance for insecticide1 in the mixture, and has a similar effect on it's use in the sequence (Fig 10A). However, it has little effect on resistance to insecticide2. Because of this sequential use continues to generate a longer time-to-resistance than the mixture. Increasing the resistance restoration coefficient of both alleles to 0.8 results in a shorter time-to-resistance  for the mixture (Fig 10B), however the relative shape of the resistance curves remains similar to the base scenario  (Fig 6A), with sequential use continuing to generate longer time-to-resistance.  


#### results: Starting frequencies of resistance
Changing the starting frequency of resistance had a similar effect on time to resistance for both sequences and mixtures and thus had little effect on their relative performance. For example taking the base scenario and reducing the starting frequency of one resistance allele did not change from sequence being favoured (compare Fig 11A to Fig 6A). Similarly taking the base scenario with effectiveness of the first insecticide increased to 0.8 (Fig 6B) and decreasing starting frequency of that resistance allele did not result in the mixture being favoured (Fig 11B). 


## Discussion

The response of resistance to insecticide use in the model can be explained by a number of mechanisms that can help us develop a more robust understanding of how we would expect resistance to respond in the field.


When single insecticide use was represented (Figs 3-5) in all cases the initial increase in resistance was most rapid with straight lines on the log plots up to around 50% followed by a slowing rate of increase up to 100%. Higher values of the five inputs investigated all led to more rapid increases in resistance. 


For single insecticide use resistance responded identically to changing exposure and effectiveness (compare Fig 3A to 3B). This makes sense as vector kill is effectively a product of exposure times effectiveness. For example exposing 50% of a  population to an insecticide which is 75% effective would be expecetd to have the same result as exposing 75% of the population to one which is 50% effective. This observation points to the mechanism by which increasing both exposure and effectiveness lead to a faster increase in resistance. In both cases the increased deaths of susceptible vectors cause a higher selection pressure that can explain the faster increase.


The pattern of more rapid increase in resistance at higher dominance levels (Fig 4A) can be explained by increased survival of heterozygotes in the presence of the insecticide. Higher dominance of the resistant allele causes it to contribute more to the phenotype of the heterozygotes leading to higher survival. Thus selection pressure for the resistance allele will be increased because it confers more of an advantage when only present on one chromosome.  



The faster development of resistance under higher resistance-restoration (Fig 4B) can be explained by it's effect on the survival of the resistant genotypes. Resistance-restoration restores the survival of resistant genotypes in the presence of the insecticide back towards what it would be in the absence of the insecticide, thus increasing the selection pressure of the resistance allele.


The effect of the starting frequency of resistance (Fig 5) is the most different from the other inputs and perhaps the easiest to explain. Simply when starting from a higher frequency of resistance there is a smaller change to make to reach the higher resistance thresholds.


These mechanisms explaining the response of resistance to single insecticide use under different input values are summarised in Table 2 and Fig 12. Exposure and effectiveness act by decreasing the survival of all genotypes, dominance acts by increasing survival of RS and resistance-restoration acts by increasing survival of RR & RS. 


#### discussion: Two insecticides

In comparison with the use of a single insecticide, using two insecticides either in sequence or in mixtures differs in some ways and where it differs that can again help us to understand the mechanisms. Looking at our base scenario (Fig 6A) the curves for resistance to both insecticides in the mixture are shallower than those for sequential use and in this particular example are identical because they have set the same parameter values for each insecticide to be the same. The shallower curves for the mixture can be explained by each insecticide killing individuals that are resistant to the other insecticide. Thus each insecticide reduces the selection pressure for the increase in resistance to the other and could be said to 'protect' the other. However this protection is not necessarily enough to ensure that resistance arises more slowly in a mixture relative to a sequential strategy. As shown in our base scenario, resistance can arise more slowly for both insecticides in sequential use, despite being faster for each, because they occur one after the other.


#### discussion: Insecticide effectiveness

The main difference between mixtures and the other strategies is that in mixtures increasing the effectiveness of either insecticide slows the development of resistance to both (Fig 6B). In contrast in both the sequential (Fig 6B) and single insecticide (Fig 3A) experiments resistance was speeded up by increasing effectiveness. This can be explained by the effect that in a mixture increased effectiveness of one insecticide increases killing of vectors that are resistant to the other and thus decreases selection pressure.


This effect can be seen by comparing Fig 6B, where the effectiveness of insecticide 1 has been increased, to 6A. In the mixture, resistance to insecticide 1 (with the increased effectiveness) rises at a similar speed in both figures. However, the increased effectiveness of insecticide 1 causes resistance to insecticide 2 to increase more slowly initially in the mixture. Once insecticide 1 reaches resistance of around 50% at around 50 generations, the curve for insecticide 2 becomes steeper. This can be explained by the mechanism that once insecticide 1 has become ineffective due to resistance it stops killing indivduals that are resistant to insecticide 2 and thus stops 'protecting' it from it's own rise in resistance. A similar effect is visible when the effectiveness of both insecticides are increased (Fig 7). The identical resistance curves for each insecticide in the mixture are shallower than at the lower effectiveness (Fig 6A) because more individuals resistant to each insecticide are being killed by the other insecticide. In this case the 'protection' given to both insecticides by the other declines at the same rate so we don't see the change in slope seen in Fig 6B. 


Fig 6B also demonstrates that when two insecticides have a different effectiveness in a mixture, other parameters being equal resistance will be expected to increase faster to the more effective insecticide. The more effective insecticide prompts both a) higher selection pressure for it's own resistance and b) greater 'protection' reducing the rise in resistance to the other insecticide.     


#### discussion: Exposure


**Ian, Matt this is still the bit I can't quite explain. Any suggestions ?**


The biggest difference I can't explain is why that in mixtures, increasing the exposure to both insecticides results in a decrease in time-to-resistance (from 90 in Fig 6A to 40 in Fig 8A) and yet increasing the effectiveness of both insecticides by the same amount results in a slight increase in time-to-resistance (from 90 in Fig 6A to 100 in Fig 7). This contrasts with the identical effects that exposure and effectiveness have on a single insecticide (Figs 3 A,B) and on insecticides in sequence (compare Figs 7 & 8A). 

either

1. Why doesn't increased exposure provide 'protection' to the other insecticides in a mixture ?
1. Why doesn't increased effectiveness lead to a greater selection for resistance in each insecticide ?
1. Why do exposure & effectivness have the same effect on a sequence but different effects on a mixture ?


*some previous guesswork I'm now not sure about: Increasing exposure gives shorter time-to-resistance for both mixtures and sequences due to increased deaths of susceptibles creating a higher selection pressure. In a mixture the effect of exposure is greater and this means that increasing exposure can make sequences preferable to mixtures. The reason for the greater effect of exposure on mixtures could be that exposure is having both a direct effect on each insecticide and an indirect effect on the other. Thus higher exposures lead to faster resistance in each insecticide (direct), in turn increased resistance to each insecticide reduces the 'protection' that it gives the other, leading to faster resistance in the other (indirect). This could act as a postive feedback loop where faster resistance in one contributes to faster resistance in the other.*   


Mechanisms for the response of resistance in mixtures are summarised in Table 3. Table 4 summarises mechanisms explaining the difference between mixture and sequential strategies.



### Discussion summary points

(@) In a mixture each insecticide reduces the rate of increase in resistance to the other by killing individuals that are resistant to the other.

(@) In a mixture higher effectiveness of either insecticide kills more individuals resistant to the other and thus increases time-to-resistance for the other. Thus although increasing effectiveness of an insecticide decreases time-to-resistance when used alone, when used in a mixture time-to-resistance for both insecticides is increased.

(@) For a mixture of 2 insecticides with differing effectiveness. Resistance to the insecticide with a greater effectiveness increases faster. The less effective insecticide is 'protected' by the more effective. Resistance to the less effective insecticide increases slowly until resistance to the more effective insecticide reaches a high level.

(@) exposure ...

(@) ? In a mixture the effectiveness of one insecticide has major effects on the resistance of the other. In contrast the dominance and selective advantage of one insecticide has less effect on the resistance of the other. For exposure we kept values the same for each insecticide (to represent a mixture in which the 2 insecticides are applied together). However we predict that if they were applied separately then (similar to effectiveness) the level of exposure to one insecticide would influence the time-to-resistance of the other. 

[Summary tables to refer to from discussion.]

**Table 2. Effect of inputs on resistance when insecticides used singly or in sequence**

Parameter to increase  | effect on resistance | Mechanism
------------------ | ------- | ---------------------------------------------------
1. Effectiveness | faster | increased deaths of susceptibles
2. Exposure | faster | increased deaths of susceptibles
3. Dominance | faster | increased survival of heterozygotes
4. Resistance restoration | faster | increased survival of resistants
5. Frequency  | faster | less change needed to reach resistance threshold

**Table 3. Effect of inputs on resistance when insecticides used in a mixture**

Parameter to increase  | effect on resistance | Mechanism
------------------ | --------- | ---------------------------------------------------
1. Effectiveness | **slower** | increased deaths of individuals resistant to the other insecticide
2. Exposure | faster (but less than for single) | increased deaths of individuals susceptible to one insecticide increases selection pressure for that resistance. However at the same time selection pressure is reduced by higher deaths of resistant individuals caused by the other insecticide.
3. Dominance | faster | increased survival of resistants
4. Resistance restoration | faster | increased survival of resistants
5. Frequency  | faster | less change needed to reach resistance threshold

**Table 4. Effect of inputs on the difference between mixture and sequential use**

Parameter to increase  | increase favours mix or sequence | Mechanism
------------------ | ------- | ---------------------------------------------------
1. Effectiveness | mixture | Higher effectiveness gives faster resistance for sequence and slower resistance in mixture
2. Exposure | sequence | Higher exposure gives faster resistance for sequence and mixture but the greater effect on mixture favours sequence.
3. Dominance | neither | Higher dominance gives faster resistance in both sequences and mixtures such that the difference between them is not changed. 
4. Resistance restoration | neither | As for dominance. Higher resistance restoration gives faster resistance in both sequences and mixtures such that the difference between them is not changed.
5. Frequency  | neither | As for dominance and resistance restoration. Higher starting frequencies give faster resistance in both sequences and mixtures such that the difference between them is not changed.








## References
1. GPIRM
1. Curtis 
1. Mani GS. Evolution of resistance in the presence of two insecticides. Genetics 1985;109(4):761â€“83.
1. Birget 2015
1. Curtis et al 1993, 
1. Georghiou 1983 Management of resistance in Arthropods.
potential IRM strategies :
~ moderation : preserve susceptible genes by limiting selection pressure
~ saturation : high dose so that heterozygous resistants are killed
~ multiple attack : independently acting pressures neither of which is strong enough to lead to resistance



## Todo

1. In discussion and maybe elewhere address potential concern that the relationships shown here may not hold for all of paramter space.
1. can I develop explanatory diagrams to describe the input parameters ?
1. mention generation time of 1 month
1. mention other potential effects e.g. differential exposure of M&F, sex linkage, ...
1. add to discussion about relevance of these mechanisms in the field
1. e.g. exposure can be reduced if either insecticide has a repellant effect, which can be set in formulation. (Birget & Koella 2015 mention this not for resistance but for ITNs with repellancy requiring higher coverage for elimination)

\pagebreak

## Figures

![Building up the model structure.](paper2_mod_graphic_a_to_c.png)


![Exposure to insecticides in the model.](paper2_mod_graphic_d.png)


```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3, fig.show='hold', fig.align='left', fig.cap="Effect of inputs on single insecticide use. A. Effectiveness, B. Exposure"}

  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.2,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.8,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  #input <- cbind(input, inputOneScenario)
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(phi.SS1_A0))) + 
         theme_bw() +  
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) +  
         labs(colour = "effectiveness") +
         coord_trans(y = "log10") +    
         geom_line()   
         
       ) 
  


  exposure <- 0.2
  a <- setExposure(exposure = exposure, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      exposure = exposure, #used for post-run analysis
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
 
  exposure <- 0.5
  a <- setExposure(exposure = exposure, insecticideUsed='insecticide1')   

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      exposure = exposure, #used for post-run analysis
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  exposure <- 0.8
  a <- setExposure(exposure = exposure, insecticideUsed='insecticide1')  
  
  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      exposure = exposure, #used for post-run analysis
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(exposure))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) +
         labs(colour = "exposure", y=NULL) +
         coord_trans(y = "log10") +   
         geom_line()   
         
       )
  
```


```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3, fig.show='hold', fig.align='left', fig.cap="Effect of inputs on single insecticide use. A. Dominance, B. Resistance restoration"}

  #single insecticide dominance fig

  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.2, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.8, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(h.RS1_A0))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) + 
         labs(colour = "dominance") +
         coord_trans(y = "log10") + 
         geom_line()   
         
       )
  
  # single insecticide resistance restoration fig.
  
  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.2,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.8,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

    
  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(rr_restoration_ins1))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) +
         labs(colour = "resistance restoration", y=NULL) +
         coord_trans(y = "log10") +   
         geom_line()   
       )
  
```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3, fig.show='hold', fig.align='left', fig.cap="Effect of resistance starting frequency on single insecticide use."}

  #single insecticide frequency fig

  a <- setExposure(exposure=0.5, insecticideUsed='insecticide1')

  i1 <- setInputOneScenario( max_gen = 500,
                      P_1 = 0.001,       
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i2 <- setInputOneScenario( max_gen = 500,
                      P_1 = 0.01,       
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )

  i3 <- setInputOneScenario( max_gen = 500,
                      P_1 = 0.1,       
                      h.RS1_A0 = 0.5, 
                      h.RS2_0B = 0.5,
                      a = a,
                      phi.SS1_A0 = 0.5,
                      phi.SS2_0B = 0.5,
                      rr_restoration_ins1 = 0.5,
                      rr_restoration_ins2 = 0.5 )
  
  input <- cbind(i1,i2,i3)
  
  listOut <- runModel2( input )
  
  df_resist <- get_resistance(locus=1, listOut)

  print( ggplot(df_resist, aes(x=generation, y=resistance, colour=factor(P_1))) + 
         theme_bw() +
         theme(legend.position = "bottom", legend.key = element_blank()) + 
         guides(colour = guide_legend(reverse=TRUE)) + 
         labs(colour = "start\nfrequency") +
         coord_trans(y = "log10") + 
         geom_line()   
         
       )
```



```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. All control inputs equal at 0.5, B. Effectiveness of insecticide1 increased from 0.5 to 0.8"}
#effectiveness on mixture

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.', maxX = 120 )

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab="", ylabs = FALSE, main='B.', maxX = 120 )

par(oldpar)

```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="Effectiveness of both insecticides 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.8 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), maxX = 120 )

```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Exposure increased to 0.8, B. Exposure and Effectiveness of insecticide1 increased from 0.5 to 0.8"}
#fig.cap seems necessary to keep figs side by side

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)


runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.8 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.', maxX = 120 )
#cat("Fig. Exposure 0.8 benefit of sequence over mixture increases")

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.8 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylabs = FALSE, main='B.', maxX = 120 )
#cat("Fig. Effectiveness 0.8, Exposure 0.8, increased exposure nullifies the effect of increased effectiveness, sequence remains better")
```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Dominance of insecticide1 0.8, B. Dominance of both insecticides 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.8 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.', maxX = 120 )
#cat("Dominance of insecticide1 0.8")

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.8 , h.RS2_0B = 0.8 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab='', ylabs = FALSE, main='B.', maxX = 120 )
#cat("Dominance of both insecticides 0.8")

par(oldpar)

```


```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Resistance restoration coefficient allele1 0.8, B. Resistance restoration coefficient both alleles 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.8 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.', maxX = 120 )
#cat("Fig. rr_restoration I1 0.8")

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

runcurtis_f2( max_gen=500,  P_1 = 0.01 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.8 , rr_restoration_ins2 = 0.8 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab='', ylabs = FALSE, main='B.', maxX = 120 )
#cat("Fig. CC. rr_restoration I2 0.2")

par(oldpar)

```

```{r, eval=TRUE, echo=FALSE, fig.height=3.7, fig.width=3.7, fig.show='hold', fig.align='left', fig.cap="A. Start frequency allele1 reduced from 0.001, B. as A plus effectiveness insecticide1 increased to 0.8"}

#plot margins
oldpar <- par(mar=c(4, 4, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

#P_1 to 0.001 seq remains better
runcurtis_f2( max_gen=500,  P_1 = 0.001 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.5 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), addLegend=FALSE, main='A.', maxX = 150 )

#plot margins
par(mar=c(4, 0, 2, 0)) #b,l,t,r default c(5, 4, 4, 2)

#P_1 to 0.001 & effect1 to 0.8 mix remains better
runcurtis_f2( max_gen=500,  P_1 = 0.001 , P_2 = 0.01 , h.RS1_A0 = 0.5 , h.RS2_0B = 0.5 , exposure = 0.5 , phi.SS1_A0 = 0.8 , phi.SS2_0B = 0.5 , rr_restoration_ins1 = 0.5 , rr_restoration_ins2 = 0.5 , addCombinedStrategy = FALSE, strategyLabels = c('seq','','adapt','mix2'), ylab='', ylabs = FALSE, main='B.', maxX = 150 )

par(oldpar)

```


![Summarising mechanisms of single insecticide effects.](paper2_input_effects_single.png)




